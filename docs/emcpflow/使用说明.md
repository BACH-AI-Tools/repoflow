# EMCPFlow 使用说明

## 📌 简介

EMCPFlow 是一个自动化工具，用于将 MCP (Model Context Protocol) 包一键发布到 EMCP 平台。

**新版本特性**：只需输入包地址，自动完成所有操作！

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

依赖包括：
- `requests` - HTTP 请求
- `openai` - Azure OpenAI 集成
- `pyinstaller` - 打包可执行文件（可选）

### 2. 运行程序

#### 方式一：运行简化版（推荐）

```bash
python emcpflow_simple_gui.py
```

或双击 `run_simple.bat`（Windows）

#### 方式二：运行完整版

```bash
python emcpflow_gui.py
```

或双击 `run.bat`（Windows）

---

## ⚙️ 初始配置

### 第一次使用

1. 运行程序后，点击 `[设置]` 按钮
2. 填写 EMCP 登录凭据：
   - **手机号**：您的 EMCP 账号
   - **验证码**：固定验证码
3. （可选）填写 Azure OpenAI 配置：
   - **Endpoint**: `https://your-resource.openai.azure.com/`
   - **API Key**: 您的 API Key
   - **Deployment**: 模型部署名称（如 `gpt-4`）
4. 点击 `[保存]`

### 配置文件

配置保存在用户目录：
```
Windows: C:\Users\<用户名>\.emcpflow\config.json
Linux/Mac: ~/.emcpflow/config.json
```

参考 `CONFIG_EXAMPLE.json` 查看配置格式。

---

## 📖 使用方法

### 简化版使用流程

1. **输入包地址**
   
   在输入框中输入以下任一格式：
   
   - PyPI URL: `https://pypi.org/project/requests`
   - NPM URL: `https://www.npmjs.com/package/express`
   - Docker URL: `https://hub.docker.com/r/nginx/nginx`
   - 包名: `requests` / `express` / `nginx/nginx`

2. **点击一键发布**
   
   点击 `[🚀 一键发布]` 按钮

3. **等待处理**
   
   程序会自动完成：
   - ✅ 从包管理平台获取包信息
   - ✅ 使用 AI 生成模板描述
   - ✅ 构建 EMCP 模板数据
   - ✅ 发布到 EMCP 平台

4. **完成**
   
   看到 "🎉 发布完成！" 即成功

---

## 📦 支持的包类型

### PyPI 包

**输入示例**：
```
https://pypi.org/project/requests
requests
numpy
flask
```

**自动生成**：
- 包类型：PyPI
- 启动命令：`python -m package_name`
- 从 PyPI API 获取版本、描述等信息

### NPM 包

**输入示例**：
```
https://www.npmjs.com/package/express
express
@vue/cli
react
```

**自动生成**：
- 包类型：NPM
- 启动命令：`package-name`（npx 会自动添加）
- 从 NPM Registry 获取版本、描述等信息

### Docker 镜像

**输入示例**：
```
https://hub.docker.com/r/nginx/nginx
nginx/nginx
mysql/mysql-server
```

**自动生成**：
- 包类型：Docker
- 从 Docker Hub API 获取镜像信息

---

## 🤖 AI 生成功能

### 使用 Azure OpenAI

配置 Azure OpenAI 后，系统会：

1. **自动生成专业描述**
   - 中文名称（简短、吸引人）
   - 一句话简介（突出核心功能）
   - 详细功能描述（100-300字）
   - 建议的路由前缀

2. **提升发布质量**
   - 更专业的模板描述
   - 更吸引人的文案
   - 更准确的分类建议

### 不使用 AI

未配置 Azure OpenAI 时，系统会：

1. **使用基础生成器**
   - 从包的原始描述生成
   - 自动提取关键信息
   - 基本可用

2. **功能完整**
   - 所有核心功能都可用
   - 只是描述可能不如 AI 生成的专业

---

## 🎯 使用示例

### 示例 1: 发布 PyPI 包 - requests

**步骤**：
1. 输入：`requests`
2. 点击：`[一键发布]`

**处理过程**：
```
📦 步骤 1/4: 获取包信息...
   ✅ 类型: PYPI
   ✅ 包名: requests
   ✅ 版本: 2.31.0

🤖 步骤 2/4: 生成模板信息...
   ✅ 名称: Requests - Python HTTP 库
   ✅ 简介: 优雅简洁的 Python HTTP 库，专为人类设计
   ✅ 命令: python -m requests

📝 步骤 3/4: 构建发布数据...
   ✅ 模板数据已构建

🌐 步骤 4/4: 发布到 EMCP 平台...
   ✅ 发布成功！

🎉 发布完成！
```

### 示例 2: 发布 NPM 包 - express

**步骤**：
1. 输入：`https://www.npmjs.com/package/express`
2. 点击：`[一键发布]`

**处理过程**：
```
📦 步骤 1/4: 获取包信息...
   ✅ 类型: NPM
   ✅ 包名: express
   ✅ 版本: 4.18.2

🤖 步骤 2/4: 生成模板信息...
   ✅ 名称: Express - Node.js Web 框架
   ✅ 简介: 快速、开放、极简的 Node.js Web 应用框架
   ✅ 命令: express

📝 步骤 3/4: 构建发布数据...
   ✅ 模板数据已构建

🌐 步骤 4/4: 发布到 EMCP 平台...
   ✅ 发布成功！

🎉 发布完成！
```

---

## ❓ 常见问题

### Q1: 提示 "未登录 EMCP 平台"

**原因**：未配置 EMCP 登录凭据

**解决**：
1. 点击 `[设置]`
2. 填写手机号和验证码
3. 点击 `[保存]`
4. 程序会自动登录

### Q2: 提示 "无法识别的包"

**原因**：包名错误或包不存在

**解决**：
1. 检查包名拼写
2. 确认包在对应平台上存在
3. 尝试使用完整 URL

### Q3: 发布失败

**可能原因**：
- 网络连接问题
- 包已经发布过
- EMCP 平台错误
- 权限不足

**解决**：
1. 检查网络连接
2. 查看日志输出了解详细错误
3. 确认包未重复发布
4. 联系 EMCP 平台管理员

### Q4: 想要更好的模板描述

**解决**：配置 Azure OpenAI

1. 获取 Azure OpenAI 资源
2. 在设置中填写 Endpoint 和 API Key
3. 保存配置
4. 重新发布，会使用 AI 生成

### Q5: 如何批量发布

**方法**：
1. 发布第一个包
2. 等待完成
3. 输入第二个包名
4. 再次点击发布
5. 重复以上步骤

---

## 🔧 高级功能

### 手动编辑配置文件

配置文件位置：`~/.emcpflow/config.json`

```json
{
  "emcp_credentials": {
    "phone_number": "您的手机号",
    "validation_code": "您的验证码"
  },
  "azure_openai": {
    "azure_endpoint": "https://your-resource.openai.azure.com/",
    "api_key": "your-api-key",
    "deployment_name": "gpt-4",
    "api_version": "2024-02-15-preview"
  }
}
```

### 查看和复制日志

日志区域显示所有处理信息：
- 可以选中并复制
- 用于调试和问题诊断
- 显示详细的处理步骤

---

## 📚 版本对比

### 简化版 vs 完整版

| 功能 | 简化版 | 完整版 |
|-----|--------|--------|
| **输入方式** | 包地址/包名 | 本地项目文件夹 |
| **适用场景** | 已发布的包 | 本地开发项目 |
| **操作步骤** | 1 步 | 5+ 步 |
| **自动登录** | ✅ | ❌ |
| **AI 生成** | ✅ | ❌ |
| **手动编辑** | ❌ | ✅ |

**推荐**：
- 发布已有包 → 使用简化版
- 发布本地项目 → 使用完整版

---

## 🛠️ 打包可执行文件

### 打包简化版

```bash
# Windows
build_simple.bat

# Linux/Mac
pyinstaller --onefile --windowed --name=EMCPFlow-Simple emcpflow_simple_gui.py
```

生成：`dist/EMCPFlow-Simple.exe`

### 打包完整版

```bash
# Windows
build.bat

# Linux/Mac
pyinstaller --onefile --windowed --name=EMCPFlow emcpflow_gui.py
```

生成：`dist/EMCPFlow.exe`

---

## 🔗 相关链接

- **EMCP 测试环境**: https://sit-emcp.kaleido.guru
- **EMCP 正式环境**: https://emcp.kaleido.guru
- **PyPI**: https://pypi.org
- **NPM**: https://www.npmjs.com
- **Docker Hub**: https://hub.docker.com

---

## 📞 技术支持

如有问题，请：
1. 查看日志输出
2. 检查配置文件
3. 参考常见问题
4. 联系开发团队

---

**Made with ❤️ by BACH Studio**


