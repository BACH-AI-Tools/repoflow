# 🚀 EMCPFlow 快速使用指南

## 📦 三大核心功能

### 1️⃣ 一键发布（自动生成 Logo）

```
输入: bachai-data-analysis-mcp
点击: 🚀 一键发布
等待: 30秒
结果: ✅ 发布完成 + 专业Logo + 模板ID
```

### 2️⃣ MCP 测试（测试工具）

```
点击: 🧪 MCP测试
等待: 1-2分钟
结果: ✅ HTML报告 + EdgeOne公开链接
```

### 3️⃣ Agent 测试（集成测试）

```
点击: 🤖 Agent测试
等待: 30-60秒
结果: ✅ Agent链接 + EMCP关闭
```

## ⚡ 快速开始

### 第一次使用

```bash
# 1. 启动程序
python emcpflow_simple_gui.py

# 2. 配置凭据（仅首次）
点击 [⚙️ 设置]
  - EMCP 手机号: 17610785055
  - EMCP 验证码: 11202505
  - Azure OpenAI (可选)
保存

# 3. 开始使用！
```

### 标准流程

```
步骤 1: 输入包地址
  bachai-data-analysis-mcp

步骤 2: 点击 [🚀 一键发布]
  ⏳ 30秒
  ✅ 发布完成
  
步骤 3: 点击 [🧪 MCP测试] (可选)
  ⏳ 1-2分钟
  ✅ 测试报告
  
步骤 4: 点击 [🤖 Agent测试]
  ⏳ 30-60秒
  ✅ Agent链接
  
步骤 5: 访问链接测试
  🔗 https://v5.kaleido.guru/chat?releaseId=xxx
  💬 对话测试 MCP 工具
```

## 📊 自动完成的事情

### 发布时

- ✅ 获取包信息（PyPI/NPM/Docker）
- ✅ AI 生成模板（三语言）
- ✅ **即梦生成 Logo**（2048x2048）⭐
- ✅ **上传 Logo 到 EMCP**（带Token认证）⭐
- ✅ **路由占用自动换路由**（随机后缀）⭐
- ✅ **PyPI 添加清华源**（加速下载）⭐
- ✅ **提取模板 ID**（支持驼峰命名）⭐

### MCP 测试时

- ✅ 创建测试 Pod Server
- ✅ 进入测试状态
- ✅ **检测 LLM 配置**（显示详情）⭐
- ✅ **LLM 生成测试参数**（智能）⭐
- ✅ **测试所有工具**（自动化）⭐
- ✅ **智能验证结果**（检查错误）⭐
- ✅ **生成 HTML 报告**（美观）⭐
- ✅ **分享到 EdgeOne**（公开链接）⭐
- ✅ 恢复发布状态

### Agent 测试时

- ✅ **登录 Agent 平台**（自动）⭐
- ✅ **创建 Agent**（LLM 生成描述）⭐
- ✅ **查询 MCP 插件**（验证存在）⭐
- ✅ **绑定 MCP 到 Agent**（自动）⭐
- ✅ **发布 Agent**（自动）⭐
- ✅ **生成测试链接**（即时访问）⭐
- ✅ **关闭 EMCP 模板**（状态改为1）⭐

## 🎯 输出结果

### 文件

- `logo_<包名>.png` - Logo 图片
- `mcp_test_report_<id>.html` - MCP 测试报告

### 链接

- **EMCP 模板**: https://sit-emcp.kaleido.guru
- **MCP 测试报告**: EdgeOne 公开链接
- **Agent 对话**: https://v5.kaleido.guru/chat?releaseId=xxx

## 📋 日志关键信息

### 发布完成

```
✅ Logo 上传成功: /api/proxyStorage/NoAuth/xxx.png
ℹ️  PyPI包已自动添加 UV_INDEX_URL 参数
✅ 模板ID: 4b52770b-xxx
💡 可以进行两种测试:
   - [🧪 MCP测试] 测试 MCP 服务的所有工具
   - [🤖 Agent测试] 创建 Agent 并测试集成
```

### MCP 测试完成

```
🤖 LLM 配置检测:
   📍 Endpoint: https://xxx.openai.azure.com/
   🎯 Deployment: gpt-4o

📊 测试统计:
   总工具数: 5
   ✅ 通过: 5
   成功率: 100.0%

💾 测试报告已保存到本地
   📂 文件路径: E:\code\EMCPFlow\mcp_test_report_xxx.html
   
🌐 报告已分享
   🔗 公开链接: https://mcp-on-edge.edgeone.app/kv/get?key=xxx
```

### Agent 测试完成

```
✅ Agent 已创建, ID: 1231
✅ 找到匹配的 MCP: 巴赫数据分析服务器
✅ Agent 已发布, 发布ID: 6297
🔗 访问链接: https://v5.kaleido.guru/chat?releaseId=6297
✅ EMCP 模板已关闭（状态改为1）
```

## ⚙️ 配置说明

### 必需配置

- **EMCP 凭据** ✅ 必需
  - 手机号: 17610785055
  - 验证码: 11202505

### 可选配置

- **Azure OpenAI** ⭐ 推荐
  - 用于: 模板生成、测试参数、Agent描述
  - 不配置: 使用简单默认值

## 🔍 常见问题

### Q: Logo 生成失败？

**A**: 检查日志中的错误信息
- Token 过期 → 自动重登录
- 网络问题 → 使用默认 Logo

### Q: 路由占用怎么办？

**A**: 自动处理
- 检测到占用 → 自动添加数字后缀
- 例如: dataanaly → dataanaly42

### Q: MCP 测试显示 404？

**A**: 检查 LLM 配置
- 查看日志中的配置检测
- 确认 Deployment 名称正确
- 不影响使用（会降级到默认值）

### Q: Agent 测试找不到 MCP？

**A**: 确认发布成功
- MCP 必须先发布到 EMCP
- 等待几秒让系统同步
- 查看插件列表日志

### Q: EdgeOne 分享失败？

**A**: 使用本地文件
- 本地报告仍然可用
- 可能是网络或代理问题
- 本地路径在日志中

## 🎉 成果展示

### 发布的包

- ✅ 专业的 Logo
- ✅ 三语言模板
- ✅ 清华源加速
- ✅ 自动化部署

### MCP 测试报告

- ✅ 工具可用性分析
- ✅ 成功率统计
- ✅ 详细测试记录
- ✅ 公开分享链接

### Agent 测试

- ✅ 自动创建 Agent
- ✅ 自动绑定 MCP
- ✅ 即时对话测试
- ✅ EMCP 自动关闭

## 📞 技术支持

- **EMCP 平台**: https://sit-emcp.kaleido.guru
- **Agent 平台**: https://v5.kaleido.guru/
- **项目地址**: EMCPFlow
- **开发团队**: 巴赫工作室

---

**快速开始，3-5分钟完成发布和测试！** 🚀

**Made with ❤️ by 巴赫工作室 (BACH Studio)**

